<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seal Generator</title>
    <style>
        /* styles.css */
body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f9f9f9;
}

.container {
    text-align: center;
}

input {
    margin: 10px;
}

button {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
}

    </style>
</head>
<body>
    <div class="container">
        <h1>Seal Generator</h1>
        <input type="file" id="pdfInput" accept="application/pdf">
        <input type="text" id="customText" placeholder="Enter text for the seal">
        <input type="file" id="logoInput" accept="image/*">
        <button id="generate">Generate Seal</button>
        <a id="download" style="display:none;">Download PDF</a>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // script.js
document.getElementById('generate').addEventListener('click', async function() {
    const { PDFDocument } = PDFLib;
    const { jsPDF } = window.jspdf;

    const pdfInput = document.getElementById('pdfInput').files[0];
    const customText = document.getElementById('customText').value;
    const logoInput = document.getElementById('logoInput').files[0];

    if (!pdfInput) {
        alert('Please upload a PDF file.');
        return;
    }

    // Load the uploaded PDF
    const pdfData = await pdfInput.arrayBuffer();
    const existingPdfDoc = await PDFDocument.load(pdfData);
    const newPdfDoc = await PDFDocument.create();

    // Copy pages from existing PDF
    const numPages = existingPdfDoc.getPageCount();
    for (let i = 0; i < numPages; i++) {
        const [copiedPage] = await newPdfDoc.copyPages(existingPdfDoc, [i]);
        newPdfDoc.addPage(copiedPage);
    }

    // Create a new jsPDF instance
    const pdfBytes = await newPdfDoc.save();
    const doc = new jsPDF();

    // Load the PDF pages into jsPDF
    const pdfDoc = new jsPDF();
    const pages = await pdfDoc.splitTextToSize(pdfBytes);
    pages.forEach(page => {
        doc.addPage();
        doc.text(page, 10, 10);
    });

    // Generate random position for the seal
    const x = Math.random() * (doc.internal.pageSize.getWidth() - 50); // Adjust for logo size
    const y = Math.random() * (doc.internal.pageSize.getHeight() - 50); // Adjust for logo size

    // Load logo if provided
    if (logoInput) {
        const logoUrl = URL.createObjectURL(logoInput);
        const img = new Image();
        img.src = logoUrl;
        img.onload = function() {
            doc.addImage(img, 'PNG', x, y, 50, 50); // Adjust dimensions as needed
            addTextToPDF(doc, customText, x, y + 60); // Place custom text below the logo

            // Save the PDF
            savePDF(doc);
        };
    } else {
        addTextToPDF(doc, customText, x, y); // Place custom text at random position
        savePDF(doc);
    }
});

// Function to add text to PDF
function addTextToPDF(doc, text, x, y) {
    const timestamp = new Date().toLocaleString();
    doc.setFontSize(20);
    doc.text(text, x, y);
    doc.setFontSize(10);
    doc.text(`Generated on: ${timestamp}`, x, y + 10);
}

// Function to save the PDF
function savePDF(doc) {
    const pdfOutput = doc.output('blob');
    const url = URL.createObjectURL(pdfOutput);

    const downloadLink = document.getElementById('download');
    downloadLink.href = url;
    downloadLink.download = 'seal.pdf';
    downloadLink.style.display = 'block';
    downloadLink.textContent = 'Download PDF';
}

    </script>
</body>
</html>
